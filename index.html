<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>اختبار المراجعة الشاملة - كلية الطب</title>
    <style>
        :root {
            --bg-body: #f3f4f6;
            --bg-card: #ffffff;
            --primary: #2563eb;
            --text-dark: #111827;
            --text-muted: #4b5563;
            --border-light: #e5e7eb;
            --option-bg-hover: #eff6ff;
            --correct-bg: #ecfdf5;
            --correct-text: #065f46;
            --correct-border: #a7f3d0;
            --wrong-bg: #fef2f2;
            --wrong-text: #991b1b;
            --wrong-border: #fecaca;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: system-ui, -apple-system, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-body);
            color: var(--text-dark);
            margin: 0;
            padding: 0;
            line-height: 1.6;
        }

        .page-header {
            background-color: var(--bg-card);
            border-bottom: 1px solid var(--border-light);
            padding: 30px 20px;
            text-align: center;
            margin-bottom: 40px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        .page-header h1 {
            margin: 0;
            font-size: 26px;
            color: var(--primary);
        }

        .page-header p {
            margin: 10px 0 0 0;
            font-size: 16px;
            color: var(--text-muted);
        }

        .container {
            max-width: 750px;
            margin: 0 auto;
            padding: 0 15px;
        }

        .question-card {
            background-color: var(--bg-card);
            border: 1px solid var(--border-light);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
        }

        .question-title {
            font-size: 18px;
            font-weight: 600;
            margin-top: 0;
            margin-bottom: 25px;
            color: var(--text-dark);
        }

        .options-list {
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option-item {
            display: block;
        }

        .option-label {
            display: flex;
            align-items: center;
            padding: 16px;
            border: 2px solid var(--border-light);
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s, border-color 0.2s;
            font-size: 16px;
            color: var(--text-dark);
        }

        .option-label:hover:not(.disabled) {
            background-color: var(--option-bg-hover);
            border-color: #bfdbfe;
        }

        .option-label.disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }

        input[type="radio"] {
            margin-left: 15px;
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
            cursor: pointer;
        }

        input[type="radio"]:disabled {
            cursor: not-allowed;
        }

        .feedback-box {
            margin-top: 25px;
            display: none;
            border-radius: 8px;
            overflow: hidden;
            animation: fadeIn 0.4s ease;
        }

        .feedback-message {
            padding: 16px;
            font-weight: bold;
            font-size: 16px;
            border-bottom: 1px solid transparent;
        }

        .feedback-explanation {
            padding: 16px;
            font-size: 15px;
            background-color: #f8fafc;
            color: var(--text-muted);
            border: 1px solid var(--border-light);
            border-top: none;
            border-bottom-left-radius: 8px;
            border-bottom-right-radius: 8px;
        }

        .state-correct .feedback-message {
            background-color: var(--correct-bg);
            color: var(--correct-text);
            border-color: var(--correct-border);
            border-radius: 8px;
        }

        .state-wrong .feedback-message {
            background-color: var(--wrong-bg);
            color: var(--wrong-text);
            border-color: var(--wrong-border);
            border-top-left-radius: 8px;
            border-top-right-radius: 8px;
        }

        .loading-alert {
            text-align: center;
            background-color: var(--wrong-bg);
            color: var(--wrong-text);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid var(--wrong-border);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-5px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>

    <header class="page-header">
        <h1>مراجعة الكيمياء الطبية - النظري</h1>
        <p>جامعة ديالى - كلية الطب</p>
    </header>

    <main class="container" id="quiz-container">
        </main>

    <script>
        fetch('question.json')
            .then(response => {
                if (!response.ok) {
                    throw new Error('فشل في تحميل ملف الأسئلة');
                }
                return response.json();
            })
            .then(data => renderQuestions(data))
            .catch(error => {
                const container = document.getElementById('quiz-container');
                container.innerHTML = `
                    <div class="loading-alert">
                        <b>تنبيه:</b> لم أتمكن من العثور على ملف questions.json.<br>
                        تأكد من وجود الملف بجانب هذا الكود وتشغيل الصفحة عبر خادم محلي (Local Server).
                    </div>`;
            });

        function renderQuestions(questions) {
            const container = document.getElementById('quiz-container');
            const optionLetters = ['A', 'B', 'C', 'D'];

            questions.forEach((q, index) => {
                const card = document.createElement('div');
                card.className = 'question-card';

                const title = document.createElement('h3');
                title.className = 'question-title';
                title.innerText = `Q ${index + 1}: ${q.question}`;
                card.appendChild(title);

                const list = document.createElement('ul');
                list.className = 'options-list';

                const labelsArray = [];

                // حاوية النتيجة (تم إنشاؤها مسبقاً لإظهارها فور الاختيار)
                const feedbackBox = document.createElement('div');
                feedbackBox.className = 'feedback-box';

                const messageDiv = document.createElement('div');
                messageDiv.className = 'feedback-message';
                feedbackBox.appendChild(messageDiv);

                const explanationDiv = document.createElement('div');
                explanationDiv.className = 'feedback-explanation';
                explanationDiv.innerHTML = `<b>توضيح:</b> ${q.explanation}`;
                feedbackBox.appendChild(explanationDiv);

                q.options.forEach((optText, optIndex) => {
                    const listItem = document.createElement('li');
                    listItem.className = 'option-item';

                    const label = document.createElement('label');
                    label.className = 'option-label';
                    labelsArray.push(label);
                    
                    const radioBtn = document.createElement('input');
                    radioBtn.type = 'radio';
                    radioBtn.name = `question_${index}`;
                    radioBtn.value = optionLetters[optIndex];

                    label.appendChild(radioBtn);
                    
                    const textContent = document.createTextNode(` ${optionLetters[optIndex]}) ${optText}`);
                    label.appendChild(textContent);
                    
                    listItem.appendChild(label);
                    list.appendChild(listItem);

                    // برمجة حدث التغيير لزر الراديو ليتم التحقق فوراً
                    radioBtn.addEventListener('change', () => {
                        
                        // تعطيل جميع الخيارات لهذا السؤال بمجرد الاختيار
                        const allRadios = document.querySelectorAll(`input[name="question_${index}"]`);
                        allRadios.forEach(r => r.disabled = true);
                        labelsArray.forEach(l => l.classList.add('disabled'));

                        feedbackBox.style.display = 'block';

                        if (radioBtn.value === q.answer) {
                            // إجابة صحيحة
                            feedbackBox.className = 'feedback-box state-correct';
                            messageDiv.innerText = '✅';
                            explanationDiv.style.display = 'block'; // لا حاجة للتوضيح
                        } else {
                            // إجابة خاطئة
                            feedbackBox.className = 'feedback-box state-wrong';
                            messageDiv.innerHTML = `إجابة خاطئة. الجواب الصحيح هو: <b>${q.answer}</b>`;
                            explanationDiv.style.display = 'block'; // إظهار التوضيح
                        }
                    });
                });
                
                card.appendChild(list);
                card.appendChild(feedbackBox);
                container.appendChild(card);
            });
        }
    </script>
</body>
</html>
